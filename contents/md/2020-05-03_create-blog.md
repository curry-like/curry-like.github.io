---
title: ブログ作りました。
image: example.jpg
tags: Nuxt.js,GKE
created_at: 2020-05-03
---

## 概要
コロナの外出自粛のおかげでとても暇になったのでブログを作ってみました。
Nuxt.jsで作ったサイトをCloud Run上で動かしています。

## 記事公開について
### 記事の作成方法
markdownで記事を書き、その記事がremoteのmasterブランチにマージされると自動でデプロイされる仕組みになっています。
GKEにはCode Buildを使ってデプロイするか、Github Actionsでデプロイするか迷ったのですが、現状はGithub Actionsを使用するようにしています。

### 記事公開の仕組みについて
記事をmarkdownで記述したのち、masterにプッシュすると以下のような処理が走ります。

1. markdownから記事の情報を取り出すスクリプト(processmd)が走り、記事情報のjsonを作成
2. Nuxt.jsの静的ソースの作成
3. Dockerイメージの作成
4. GKEにデプロイ

## 料金について
かかっている料金はざっくり以下のようになっています。

- ドメイン
- GKEのインスタンス使用量
- ネットワーク使用量

GKEのインスタンスに関してはspotインスタンスを使用しているので料金は抑えられているかと思います。
一応GCPの無料枠もあるのですが、そこそこ使ってしまいそうです。
Cloud Runについても考えたのですが、速度面等も考慮してこちらを使用することにしました。

以下サンプルコードです。
```javascript
const hoge = "";
console.log(hoge);
```
